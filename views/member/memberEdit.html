<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>编辑会员</title>
    <link href="../../css/global.css" rel="stylesheet" type="text/css" />
    <link href="../../css/index.css" rel="stylesheet" type="text/css" />
    <script type="text/javascript" src="../../js/jquery-1.8.3.min.js"></script>
    <script type="text/javascript" src="../../js/layer/layer.js"></script>
    <script type="text/javascript" src="../../js/laydate/laydate.js"></script>
    <script type="application/javascript" src="../../js/qiehuan.js"></script>
    <style type="text/css">
        html,body{height:100%;padding:0;margin:0;}
    </style>
    <script type="text/javascript">
        function submitForm(){

            var memberName = document.getElementById("memberName").value;
            if (!memberName || memberName.length == 0) {
                parent.layer.alert('姓名不能为空',{icon: 2});
                return;
            }
            if($("#birthYearMonth").val() == ''){
                parent.layer.alert('出生年月不能为空',{icon: 2});
                return;
            }
            var tel = document.getElementById("tel").value;
            if (!tel || tel.length == 0) {
                parent.layer.alert('联系电话不能为空',{icon: 2});
                return;
            }
            if (!isMobil(tel)) {
                parent.layer.alert('联系电话不正确，请正确填写',{icon: 2});
                return;
            }
            var contact = document.getElementById("contact").value;
            if (!contact || contact.length == 0) {
                parent.layer.alert('联系人不能为空',{icon: 2});
                return;
            }
            var workStatus = document.getElementById("workStatus").value;
            if (!workStatus || workStatus.length == 0) {
                parent.layer.alert('工作状态不能为空',{icon: 2});
                return;
            }
            var motherEducation = document.getElementById("motherEducation").value;
            if (!motherEducation || motherEducation.length == 0) {
                parent.layer.alert('妈妈学历不能为空',{icon: 2});
                return;
            }
            var fatherEducation = document.getElementById("fatherEducation").value;
            if (!fatherEducation || fatherEducation.length == 0) {
                parent.layer.alert('爸爸学历不能为空',{icon: 2});
                return;
            }
            var address = document.getElementById("address").value;
            if (!address || address.length == 0) {
                parent.layer.alert('居住地址不能为空',{icon: 2});
                return;
            }
            var deliveryMode = document.getElementById("deliveryMode").value;
            if (!deliveryMode || deliveryMode.length == 0) {
                parent.layer.alert('分娩方式不能为空',{icon: 2});
                return;
            }
            var deliveryWeeks = document.getElementById("deliveryWeeks").value;
            if (!deliveryWeeks || deliveryWeeks.length == 0) {
                parent.layer.alert('分娩时孕周不能为空',{icon: 2});
                return;
            }
            var deliveryHospital = document.getElementById("deliveryHospital").value;
            if (!deliveryHospital || deliveryHospital.length == 0) {
                parent.layer.alert('分娩医院不能为空',{icon: 2});
                return;
            }
            var parentTraining = document.getElementById("parentTraining").value;
            if (!parentTraining || parentTraining.length == 0) {
                parent.layer.alert('参与育儿不能为空',{icon: 2});
                return;
            }
            var secondChildExperience = document.getElementById("secondChildExperience").value;
            if (!secondChildExperience || secondChildExperience.length == 0) {
                parent.layer.alert('二胎经验不能为空',{icon: 2});
                return;
            }
            var secondChildExperienceRemark = document.getElementById("secondChildExperienceRemark").value;
            if (!secondChildExperienceRemark || secondChildExperienceRemark.length == 0) {
                parent.layer.alert('二胎经验备注不能为空',{icon: 2});
                return;
            }
            var wifeBreastfeedTime = document.getElementById("wifeBreastfeedTime").value;
            if (!wifeBreastfeedTime || wifeBreastfeedTime.length == 0) {
                parent.layer.alert('妻子儿时母乳多久不能为空',{icon: 2});
                return;
            }
            var husbandBreastfeedTime = document.getElementById("husbandBreastfeedTime").value;
            if (!husbandBreastfeedTime || husbandBreastfeedTime.length == 0) {
                parent.layer.alert('丈夫儿时母乳多久不能为空',{icon: 2});
                return;
            }
            var breastfeedReason = document.getElementById("breastfeedReason").value;
            if (!breastfeedReason || breastfeedReason.length == 0) {
                parent.layer.alert('母乳喂养理由不能为空',{icon: 2});
                return;
            }
            var childSex = document.getElementById("childSex").value;
            if (!childSex || childSex.length == 0) {
                parent.layer.alert('宝宝性别不能为空',{icon: 2});
                return;
            }
            var childWeight = document.getElementById("childWeight").value;
            if (!childWeight || childWeight.length == 0) {
                parent.layer.alert('出生体重不能为空',{icon: 2});
                return;
            }
            var childBirthday = document.getElementById("childBirthday").value;
            if (!childBirthday || childBirthday.length == 0) {
                parent.layer.alert('出生日期不能为空',{icon: 2});
                return;
            }

            var understandJinQuanChannelStr = "";
            $("input[name='understandJinQuanChannel']").each(function(){
                if($(this).attr("checked") == 'checked'){
                    understandJinQuanChannelStr +=$(this).val() + ",";
                }
            });
            if(understandJinQuanChannelStr == ''){
                parent.layer.alert('如何知道金泉不能为空',{icon: 2});
                return;
            }


            //处理医院添加 start
            var hospitalizationArr = $("input[name='hospitalizationArr']:checked");
            var hospitalizationStr = "";
            for(var i = 0 ; i < hospitalizationArr.length ; i ++){
                if(i != 0){
                    hospitalizationStr +=","
                }
                hospitalizationStr += hospitalizationArr[i].value;
            }
            $("#hospitalization").val(hospitalizationStr);
            //处理医院添加 end
            //辅助工具添加 start
            var assistantToolArr = $("input[name='assistantToolArr']:checked");
            var assistantToolStr = "";
            for(var i = 0 ; i < assistantToolArr.length ; i ++){
                if(i != 0){
                    assistantToolStr +=","
                }
                assistantToolStr += assistantToolArr[i].value;
            }
            $("#assistantTool").val(assistantToolStr);
            //辅助工具添加 end
            //特殊说明添加 start
            var specialInstructionsArr = $("input[name='specialInstructionsArr']:checked");
            var specialInstructionsStr = "";
            for(var i = 0 ; i < specialInstructionsArr.length ; i ++){
                if(i != 0){
                    specialInstructionsStr +=","
                }
                specialInstructionsStr += specialInstructionsArr[i].value;
            }
            $("#specialInstructions").val(specialInstructionsStr);
            //特殊说明添加 end
            document.getElementById("myform").submit();
        }
    </script>
</head>

<body>
<div class="r_top">
    <div class="weizhi">
        当前位置：编辑会员
    </div>
</div>
<div class="center_con">
    <form method="post" id="myform" action="/jinquan/member_doEdit">
        <table width="100%" class="reg_table"border="0" cellspacing="0" cellpadding="0">
            <tr>
                <td colspan="4" align="left">基本信息：</td>
            </tr>
            <tr>
                <input id="id" type="hidden" name="id" value="<%=member.id%>"/>
                <td class="regTd_l">会员卡信息：</td>
                <td class="regTd_r"><input id="memberCardType" name="memberCardType" type="text" class="input5" readonly="ture" value="<%=member.serialNumber%>"/>&nbsp;&nbsp;<span style="color:#FF0000;">*</span></td>
                <td  class="regTd_l">姓名：</td>
                <td class="regTd_r"><input id="memberName" name="memberName" type="text" class="input5" value="<%=member.memberName%>"/>&nbsp;&nbsp;<span style="color:#FF0000;">*</span></td>
            </tr>
            <tr>
                <td class="regTd_l">联系电话：</td>
                <td class="regTd_r"><input id="tel" name="tel" type="text" class="input5" value="<%=member.tel%>"/>&nbsp;&nbsp;<span style="color:#FF0000;">*</span></td>
                <td class="regTd_l">联系人：</td>
                <td class="regTd_r"><input id="contact" name="contact" type="text" class="input5" value="<%=member.contact%>"/>&nbsp;&nbsp;<span style="color:#FF0000;">*</span></td>
            </tr>
            <tr>
                <td  class="regTd_l">出生年月：</td>
                <td class="regTd_r"><input id="birthYearMonth" name="birthYearMonth" type="text" class="input5" value="<%=member.birthYearMonth%>" readonly onclick="laydate({istime: true, format: 'YYYY-MM'})"/>&nbsp;&nbsp;<span style="color:#FF0000;">*</span></td>
                <td class="regTd_l">工作状态：</td>
                <td class="regTd_r">
                    <select id="workStatus" name="workStatus">
                        <option value="">请选择</option>
                        <%
                        for(var i = 0 ; i < data.jobStateArr.length ; i ++){
                        %><option value="<%=data.jobStateArr[i].id%>" <%if(member.workStatus==data.jobStateArr[i].id){%>selected<%}%>><%=data.jobStateArr[i].name%></option><%
                        }
                        %>
                    </select>
                    &nbsp;&nbsp;<span style="color:#FF0000;">*</span></td>
            </tr>
            <tr>
                <td class="regTd_l">妈妈学历：</td>
                <td class="regTd_r">
                    <select id="motherEducation" name="motherEducation">
                        <option value="">请选择</option>
                        <%
                        for(var i = 0 ; i < data.educationArr.length ; i ++){
                            %><option value="<%=data.educationArr[i].id%>" <%if(member.motherEducation==data.educationArr[i].id){%>selected<%}%>><%=data.educationArr[i].name%></option><%
                        }
                        %>
                    </select>
                    &nbsp;&nbsp;<span style="color:#FF0000;">*</span></td>
                <td class="regTd_l">爸爸学历：</td>
                <td class="regTd_r">
                    <select id="fatherEducation" name="fatherEducation">
                        <option value="">请选择</option>
                        <%
                        for(var i = 0 ; i < data.educationArr.length ; i ++){
                        %><option value="<%=data.educationArr[i].id%>" <%if(member.fatherEducation==data.educationArr[i].id){%>selected<%}%>><%=data.educationArr[i].name%></option><%
                        }
                        %>
                    </select>
                    &nbsp;&nbsp;<span style="color:#FF0000;">*</span></td>
            </tr>
            <tr>
                <td class="regTd_l" >居住地址：</td>
                <td class="regTd_r" colspan="3">
                    <select name="city_district" id="city_district">
                        <option value="">请选择</option>
                        <%
                        for(var i = 0 ; i < areaNames.length ; i ++){
                        %><option value="<%=areaCodes[i]%>" <%if(member.city_district == areaCodes[i]){%>selected<%}%>><%=areaNames[i]%></option><%
                        }
                        %>
                    </select>
                    <input id="address" name="address" type="text" class="input5"   value="<%=member.address%>"/>&nbsp;&nbsp;
                    <span style="color:#FF0000;">*</span></td>
            </tr>
            <!-- 孕产信息 -->
            <tr>
                <td colspan="4" align="left">孕产信息：</td>
            </tr>
            <tr>
                <td class="regTd_l">分娩方式：</td>
                <td class="regTd_r">
                    <select id="deliveryMode" name="deliveryMode">
                        <option value="">请选择</option>
                        <%
                        for(var i = 0 ; i < data.childbirthTypeArr.length ; i ++){
                        %><option value="<%=data.childbirthTypeArr[i].id%>" <%if(member.deliveryMode==data.childbirthTypeArr[i].id){%>selected<%}%>><%=data.childbirthTypeArr[i].name%></option><%
                        }
                        %>
                    </select>
                    &nbsp;&nbsp;<span style="color:#FF0000;">*</span></td>
                <td class="regTd_l">分娩时孕周：</td>
                <td class="regTd_r">
                    <select id="deliveryWeeks" name="deliveryWeeks">
                        <option value="">请选择</option>
                        <%
                        for(var i = 0 ; i < data.childbirthWeekArr.length ; i ++){
                        %><option value="<%=data.childbirthWeekArr[i].id%>" <%if(member.deliveryWeeks==data.childbirthWeekArr[i].id){%>selected<%}%>><%=data.childbirthWeekArr[i].name%></option><%
                        }
                        %>
                    </select>
                    &nbsp;&nbsp;<span style="color:#FF0000;">*</span></td>
            </tr>
            <tr>
                <td class="regTd_l">分娩医院：</td>
                <td class="regTd_r"><input id="deliveryHospital" name="deliveryHospital" type="text" class="input5" value="<%=member.deliveryHospital%>"/>&nbsp;&nbsp;<span style="color:#FF0000;">*</span></td>
                <td class="regTd_l">参与育儿：</td>
                <td class="regTd_r">
                    <select id="parentTraining" name="parentTraining">
                        <option value="">请选择</option>
                        <%
                        for(var i = 0 ; i < data.guardianArr.length ; i ++){
                        %><option value="<%=data.guardianArr[i].id%>" <%if(member.parentTraining==data.guardianArr[i].id){%>selected<%}%>><%=data.guardianArr[i].name%></option><%
                        }
                        %>
                    </select>
                    &nbsp;&nbsp;<span style="color:#FF0000;">*</span></td>
            </tr>
            <tr>
                <td class="regTd_l">二胎经验：</td>
                <td class="regTd_r">
                    <select id="secondChildExperience" name="secondChildExperience">
                        <option value="">请选择</option>
                        <%
                        for(var i = 0 ; i < data.secondChildExperienceArr.length ; i ++){
                        %><option value="<%=data.secondChildExperienceArr[i].id%>" <%if(member.secondChildExperience==data.secondChildExperienceArr[i].id){%>selected<%}%>><%=data.secondChildExperienceArr[i].name%></option><%
                        }
                        %>
                    </select>
                    &nbsp;&nbsp;<span style="color:#FF0000;">*</span></td>
                <td class="regTd_l">二胎经验备注：</td>
                <td class="regTd_r"><input id="secondChildExperienceRemark" name="secondChildExperienceRemark" type="text" class="input5" value="<%=member.secondChildExperienceRemark%>"/>&nbsp;&nbsp;<span style="color:#FF0000;">*</span></td>
            </tr>
            <tr>
                <td class="regTd_l">妻子儿时母乳多久：</td>
                <td class="regTd_r">
                    <select id="wifeBreastfeedTime" name="wifeBreastfeedTime">
                        <option value="">请选择</option>
                        <%
                        for(var i = 0 ; i < data.eatBreastMilkTimeArr.length ; i ++){
                        %><option value="<%=data.eatBreastMilkTimeArr[i].id%>" <%if(member.wifeBreastfeedTime==data.eatBreastMilkTimeArr[i].id){%>selected<%}%>><%=data.eatBreastMilkTimeArr[i].name%></option><%
                        }
                        %>
                    </select>
                    &nbsp;&nbsp;<span style="color:#FF0000;">*</span></td>
                <td class="regTd_l">丈夫儿时母乳多久：</td>
                <td class="regTd_r">
                    <select id="husbandBreastfeedTime" name="husbandBreastfeedTime">
                        <option value="">请选择</option>
                        <%
                        for(var i = 0 ; i < data.eatBreastMilkTimeArr.length ; i ++){
                        %><option value="<%=data.eatBreastMilkTimeArr[i].id%>" <%if(member.husbandBreastfeedTime==data.eatBreastMilkTimeArr[i].id){%>selected<%}%>><%=data.eatBreastMilkTimeArr[i].name%></option><%
                        }
                        %>
                    </select>
                    &nbsp;&nbsp;<span style="color:#FF0000;">*</span></td>
            </tr>
            <tr>
                <td class="regTd_l">母乳喂养理由：</td>
                <td class="regTd_r" colspan="3">
                    <select id="breastfeedReason" name="breastfeedReason">
                        <option value="">请选择</option>
                        <%
                        for(var i = 0 ; i < data.eatBreastMilkReasonArr.length ; i ++){
                        %><option value="<%=data.eatBreastMilkReasonArr[i].id%>" <%if(member.breastfeedReason==data.eatBreastMilkReasonArr[i].id){%>selected<%}%>><%=data.eatBreastMilkReasonArr[i].name%></option><%
                        }
                        %>
                    </select>
                    &nbsp;&nbsp;<span style="color:#FF0000;">*</span></td>
            </tr>

            <!-- 宝宝信息 -->
            <tr>
                <td colspan="4" align="left">宝宝信息：</td>
            </tr>
            <tr>
                <td class="regTd_l">宝宝姓名：</td>
                <td class="regTd_r"><input id="childName" name="childName" type="text" class="input5" value="<%=member.childName%>"/>&nbsp;&nbsp;</td>
                <td class="regTd_l">宝宝性别：</td>
                <td class="regTd_r">

                    <select id="childSex" name="childSex">
                        <option value="">请选择</option>
                        <option value="男" <%if(member.childSex == '男'){%>selected<%}%>>男</option>
                        <option value="女" <%if(member.childSex == '女'){%>selected<%}%>>女</option>
                    </select>
            </tr>
            <tr>
                <td class="regTd_l">出生身高：</td>
                <td class="regTd_r">
                    <input id="childHeight" name="childHeight" type="text" class="input5" value="<%=member.childHeight%>" style="width: 85px;" onchange="isOnlyNum(this)"/>cm&nbsp;&nbsp;</td>
                <td class="regTd_l">出生体重：</td>
                <td class="regTd_r"><input id="childWeight" name="childWeight" type="text" class="input5" value="<%=member.childWeight%>" style="width: 85px;" onchange="isOnlyNum(this)"/>Kg&nbsp;&nbsp;<span style="color:#FF0000;">*</span></td>
            </tr>
            <tr>
                <td class="regTd_l">出生日期：</td>
                <td class="regTd_r"><input id="childBirthday" name="childBirthday" type="text" class="input5" value="<%=member.childBirthday%>" readonly onclick="laydate()"/>&nbsp;&nbsp;<span style="color:#FF0000;">*</span></td>
                <td class="regTd_l">如何知道金泉：</td>
                <td class="regTd_r">
                    <input id="friendsIntroduce" name="understandJinQuanChannel" type="checkbox" value="friendsIntroduce" <%if(member.understandJinQuanChannel == 'friendsIntroduce'){%>checked<%}%>>朋友介绍
                    <input id="blog" name="understandJinQuanChannel" type="checkbox"  value="blog" <%if(member.understandJinQuanChannel == 'blog'){%>checked<%}%>>微博
                    <input id="wechat" name="understandJinQuanChannel" type="checkbox"  value="wechat" <%if(member.understandJinQuanChannel == 'wechat'){%>checked<%}%>>微信
                    <input id="forum" name="understandJinQuanChannel" type="checkbox"  value="forum" <%if(member.understandJinQuanChannel == 'forum'){%>checked<%}%>>论坛/社区
                    <input id="QQ" name="understandJinQuanChannel" type="checkbox"  value="QQ" <%if(member.understandJinQuanChannel == 'QQ'){%>checked<%}%>>Q群
                    <input name="understandJinQuanChannelDes" type="text"  />
                    <span style="color:#FF0000;">*</span>
                </td>
            </tr>
            <tr>
                <td class="regTd_l">住院添加：</td>
                <td class="regTd_r">
                    <input type="hidden" id="hospitalization" name="hospitalization"/>
                    <%
                    var memberHospitalization = member.hospitalization;
                    memberHospitalization = memberHospitalization == null ? "" : memberHospitalization;
                    for(var i = 0 ; i < data.hospitalAddItemsArr.length ; i ++){
                        %><input name="hospitalizationArr" type="checkbox" value="<%=data.hospitalAddItemsArr[i].id%>" <%if(memberHospitalization.indexOf(data.hospitalAddItemsArr[i].id )>-1){%>checked<%}%>><%=data.hospitalAddItemsArr[i].name%>&nbsp;<%
                    }
                    %>
                </td>
                <td class="regTd_l">住院原因：</td>
                <td class="regTd_r"><input id="hospitalizationReason" name="hospitalizationReason" type="text" class="input5" style="widows:70%;" value="<%=member.hospitalizationReason%>"/>&nbsp;&nbsp;</td>
            </tr>
            <tr>
                <td class="regTd_l">辅助工具：</td>
                <td class="regTd_r">
                    <input type="hidden" id="assistantTool" name="assistantTool"/>
                    <%
                    var memberAssistantTool = member.assistantTool;
                    memberAssistantTool = memberAssistantTool == null ? "":memberAssistantTool;
                    for(var i = 0 ; i < data.auxiliaryToolArr.length ; i ++){
                        %><input name="assistantToolArr" type="checkbox" value="<%=data.auxiliaryToolArr[i].id%>" <%if(memberAssistantTool.indexOf(data.auxiliaryToolArr[i].id) > -1){%>checked<%}%>><%=data.auxiliaryToolArr[i].name%>&nbsp;<%
                    }
                    %>
                    </td>
                <td class="regTd_l">使用工具原因：</td>
                <td class="regTd_r">
                    <input id="useToolReason" name="useToolReason" type="text" class="input5" style="widows:70%;" value="<%=member.useToolReason%>"/>
                    &nbsp;&nbsp;</td>
            </tr>
            <tr>
                <td class="regTd_l">特殊说明：</td>
                <td class="regTd_r" colspan="3">
                    <input type="hidden" id="specialInstructions" name="specialInstructions"/>
                    <%
                    var memberSpecialInstructions = member.specialInstructions;
                    memberSpecialInstructions = memberSpecialInstructions == null?"":memberSpecialInstructions;
                    for(var i = 0 ; i < data.specialNoteArr.length ; i ++){
                    %><input name="specialInstructionsArr" type="checkbox" value="<%=data.specialNoteArr[i].id%>" <%if(memberSpecialInstructions.indexOf(data.specialNoteArr[i].id) > -1){%>checked<%}%>><%=data.specialNoteArr[i].name%>&nbsp;<%
                    }
                    %>
                </td>
            </tr>
        </table>
    </form>
    <div class="reg_but">
        <%
        if(show == ''){
            %><div class="rb_l"><a href="javascript:;" onclick="submitForm()" class="reset"></a></div><%
        }
        %>
        <div class="rb_l"><a href="/jinquan/member_list" class="close"></a></div>
    </div>


</div>
</body>
</html>
